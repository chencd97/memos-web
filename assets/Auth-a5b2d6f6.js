import{u as z,b as U,d as P,i as F,r as l,j as e,I as A,k as B,B as D,L as E,A as _,l as q,m as O,n as c,o as R,p as T}from"./index-0062afed.js";const H=()=>{const{t:a}=z(),d=U(),m=P(),n=F(!1),{appearance:g,locale:j,systemStatus:s}=d.state,x=s.profile.mode,[r,w]=l.useState(x==="demo"?"demohero":""),[o,y]=l.useState(x==="demo"?"secret":""),[f,b]=l.useState([]);l.useEffect(()=>{m.doSignOut().catch(),(async()=>{const{data:{data:i}}=await q();b(i)})()},[]);const v=t=>{const i=t.target.value;w(i)},N=t=>{const i=t.target.value;y(i)},k=t=>{d.setLocale(t)},L=t=>{d.setAppearance(t)},C=t=>{t.preventDefault(),s!=null&&s.host?p():u()},p=async()=>{if(!(r===""||o==="")&&!n.isLoading){try{n.setLoading(),await O(r,o),await m.doSignIn()?window.location.href="/":c.error(a("message.login-failed"))}catch(t){console.error(t),c.error(t.response.data.message||a("message.login-failed"))}n.setFinish()}},u=async()=>{if(!(r===""||o==="")&&!n.isLoading){try{n.setLoading(),await R(r,o),await m.doSignIn()?window.location.href="/":c.error(a("common.signup-failed"))}catch(t){console.error(t),c.error(t.response.data.message||t.message||a("common.signup-failed"))}n.setFinish()}},S=async t=>{const i=`auth.signin.${t.name}-${t.id}`;if(t.type==="OAUTH2"){const I=T("/auth/callback"),h=t.config.oauth2Config,$=`${h.authUrl}?client_id=${h.clientId}&redirect_uri=${I}&state=${i}&response_type=code&scope=${encodeURIComponent(h.scopes.join(" "))}`;window.location.href=$}};return e.jsx("div",{className:"flex flex-row justify-center items-center w-full h-full dark:bg-zinc-800",children:e.jsxs("div",{className:"w-80 max-w-full h-full py-4 flex flex-col justify-start items-center",children:[e.jsxs("div",{className:"w-full py-4 grow flex flex-col justify-center items-center",children:[e.jsxs("div",{className:"flex flex-col justify-start items-start w-full mb-4",children:[e.jsxs("div",{className:"w-full flex flex-row justify-start items-center mb-2",children:[e.jsx("img",{className:"h-12 w-auto rounded-lg mr-1",src:s.customizedProfile.logoUrl,alt:""}),e.jsx("p",{className:"text-6xl tracking-wide text-black opacity-80 dark:text-gray-200",children:s.customizedProfile.name})]}),e.jsxs("div",{id:"hitokotoStr",className:"text-sm text-gray-700 dark:text-gray-300",title:"一言功能会间隔20秒后自动获取新内容, 此功能会将内容逐一打印输出到您的浏览器控制台, 您可以打开浏览器控制台查看历史记录",children:[s.customizedProfile.description||a("common.memos-slogan"),e.jsxs("p",{children:["正在获取",e.jsx("a",{href:"https://hitokoto.cn/",children:"一言"}),"数据..."]})]})]}),e.jsxs("form",{className:"w-full",onSubmit:C,children:[e.jsxs("div",{className:`flex flex-col justify-start items-start w-full ${n.isLoading&&"opacity-80"}`,children:[e.jsxs("div",{className:"flex flex-col justify-start items-start relative w-full text-base mt-2 py-2",children:[e.jsx("span",{className:`absolute top-3 left-3 px-1 leading-10 shrink-0 text-base cursor-text text-gray-400 transition-all select-none pointer-events-none ${r?"!text-sm !top-0 !z-10 !leading-4 bg-white dark:bg-zinc-800 rounded":""}`,children:a("common.username")}),e.jsx("input",{className:"input-text w-full py-3 px-3 text-base rounded-lg dark:bg-zinc-800",type:"text",value:r,onChange:v,required:!0})]}),e.jsxs("div",{className:"flex flex-col justify-start items-start relative w-full text-base mt-2 py-2",children:[e.jsx("span",{className:`absolute top-3 left-3 px-1 leading-10 shrink-0 text-base cursor-text text-gray-400 transition-all select-none pointer-events-none ${o?"!text-sm !top-0 !z-10 !leading-4 bg-white dark:bg-zinc-800 rounded":""}`,children:a("common.password")}),e.jsx("input",{className:"input-text w-full py-3 px-3 text-base rounded-lg dark:bg-zinc-800",type:"password",value:o,onChange:N,required:!0})]})]}),e.jsx("div",{className:"flex flex-row justify-end items-center w-full mt-2",children:s!=null&&s.host?e.jsxs(e.Fragment,{children:[n.isLoading&&e.jsx(A.Loader,{className:"w-4 h-auto mr-2 animate-spin dark:text-gray-300"}),(s==null?void 0:s.allowSignUp)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:`btn-text ${n.isLoading?"cursor-wait opacity-80":""}`,onClick:u,children:a("common.sign-up")}),e.jsx("span",{className:"mr-2 font-mono text-gray-200",children:"/"})]}),e.jsx("button",{type:"submit",className:`btn-primary ${n.isLoading?"cursor-wait opacity-80":""}`,onClick:p,children:a("common.sign-in")})]}):e.jsx(e.Fragment,{children:e.jsx("button",{type:"submit",className:`btn-primary ${n.isLoading?"cursor-wait opacity-80":""}`,onClick:u,children:a("auth.signup-as-host")})})})]}),f.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"!my-4",children:a("common.or")}),e.jsx("div",{className:"w-full flex flex-col space-y-2",children:f.map(t=>e.jsx(D,{variant:"outlined",color:"neutral",className:"w-full",size:"md",onClick:()=>S(t),children:a("common.sign-in-with",{provider:t.name})},t.id))})]}),!(s!=null&&s.host)&&e.jsx("p",{className:"w-full inline-block float-right text-sm mt-4 text-gray-500 text-right whitespace-pre-wrap",children:a("auth.host-tip")})]}),e.jsxs("div",{className:"flex flex-row items-center justify-center w-full gap-2",children:[e.jsx(E,{value:j,onChange:k}),e.jsx(_,{value:g,onChange:L})]}),e.jsx("br",{}),e.jsxs("div",{className:"chencd97-auth-footer",children:["© 2023 ",e.jsx("a",{href:"https://chencd97.com",children:"chencd97"})," | Powered by ",e.jsx("a",{href:"https://github.com/usememos/memos",children:"Memos"})," | DDoS protection by ",e.jsx("a",{href:"https://www.cloudflare.com",children:"Cloudflare"})]}),e.jsx("br",{})]})})};export{H as default};
